
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>平板借還系統</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/@zxing/library@latest"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', Arial, '微軟正黑體', sans-serif;
      background: url('cyberpunk_background.png'), linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      background-size: 400px 400px, cover;
      background-repeat: repeat, no-repeat;
      background-blend-mode: overlay;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 3rem 2rem;
      color: #1d1d1f;
      line-height: 1.7;
      position: relative;
    }
    .container {
      background: rgba(255, 255, 255, 0.97);
      backdrop-filter: blur(20px);
      border-radius: 28px;
      padding: 4rem 3.5rem;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
      z-index: 1;
      text-align: center;
    }
    /* 其他CSS維持原樣 */
  </style>
</head>
<body>
  <div class="container">
    <h1>平板借還系統</h1>
    <button id="startQrBtn">開始掃描QR碼</button>
    <button id="stopQrBtn" style="display:none;">停止掃描</button>
    <video id="qr-video" style="width:100%;display:none;"></video>
    <div id="qr-result"></div>
  </div>
  <script>
    let codeReader = null;
    let scanning = false;

    document.getElementById('startQrBtn').onclick = async () => {
      if (scanning) return;
      scanning = true;
      document.getElementById('startQrBtn').style.display = 'none';
      document.getElementById('stopQrBtn').style.display = 'inline-block';
      document.getElementById('qr-video').style.display = 'block';
      document.getElementById('qr-result').textContent = "";

      codeReader = new ZXing.BrowserMultiFormatReader();
      const devices = await ZXing.BrowserMultiFormatReader.listVideoInputDevices();
      const deviceId = devices[0]?.deviceId;

      codeReader.decodeFromVideoDevice(deviceId, 'qr-video', (result, err) => {
        if (result) {
          document.getElementById('qr-result').textContent = result.text;
          stopScanning();
        }
      });
    };

    document.getElementById('stopQrBtn').onclick = () => {
      stopScanning();
    };

    function stopScanning() {
      if (codeReader) {
        codeReader.reset();
        codeReader = null;
      }
      scanning = false;
      document.getElementById('startQrBtn').style.display = 'inline-block';
      document.getElementById('stopQrBtn').style.display = 'none';
      document.getElementById('qr-video').style.display = 'none';
    }
  </script>
</body>
</html>
