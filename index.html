<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>登記表單</title>
</head>
<body>
  <h2>平板登記表</h2>
  <form id="tabletForm" autocomplete="off">
    <input type="email" name="電郵" required placeholder="電郵"><br>
    <select name="班級" required>
      <option value="">請選擇班級</option>
      <option>1A</option><option>1B</option><option>1C</option>
      <!-- 其他班級... -->
      <option>6A</option><option>6B</option><option>6C</option>
    </select><br>
    <select name="登記類型" required>
      <option>早派</option><option>晚收</option><option>其他</option>
    </select><br>
    <input type="text" name="其他原因" placeholder="其他原因"><br>
    <input type="number" name="數量" min="1" max="99" required placeholder="數量"><br>
    <textarea name="備註" placeholder="備註"></textarea><br>
    <button type="submit">提交</button>
  </form>
  <script>
    const apiUrl = "https://script.google.com/macros/s/你的EXEC_LINK/exec";
    document.getElementById('tabletForm').onsubmit = function(e){
      e.preventDefault();
      const formData = new FormData(this);
      fetch(apiUrl, {
        method: 'POST',
        body: formData,
        redirect: "follow"
      })
      .then(r => r.json())
      .then(res => {
        if(res.result === "success"){
          window.location.href = "success.html";
        }else{
          window.location.href = "fail.html";
        }
      }).catch(() => {
        window.location.href = "fail.html";
      });
    }
  </script>
</body>
</html>
